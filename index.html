<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Πρόβλεψη Ακολουθίας</title>
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.05.1/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.05.1/core.js"></script>
</head>
<body>
  <h1>Πρόβλεψη Επόμενου Αριθμού</h1>
  <div id="output">Υπολογισμός...</div>

  <py-config>
    packages = [
      "numpy",
      "scikit-learn"
    ]
  </py-config>

  <py-script>
from js import document
import numpy as np
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error

# Τεχνητό dataset αριθμητικής ακολουθίας
sequence = np.array([
    1,0,2,15,3,6,4,6,5,15,6,6,7,12,1,0,2,15,3,6,4,6,
    5,15,6,6,7,12,1,0,2,15,3,6,4,6,5,15,6,6,7,12,
    1,0,2,15,3,6,4,6,5,15,6,6,7,12,1,2,7,12,5,14,
    2,13,2,12,3,6,5,15,2,13,5,15,7,12
])

window_size = 1

X, y = [], []
for i in range(len(sequence) - window_size):
    X.append(sequence[i:i+window_size])
    y.append(sequence[i+window_size])
X = np.array(X)
y = np.array(y)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
model = RandomForestRegressor(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
mse = mean_squared_error(y_test, y_pred)

last_window = sequence[-window_size:]
next_number = model.predict([last_window])[0]

output_text = f"Mean Squared Error: {mse:.4f}<br>Επόμενος αριθμός στην ακολουθία: {next_number:.2f}"
document.getElementById("output").innerHTML = output_text
  </py-script>
</body>
</html>
